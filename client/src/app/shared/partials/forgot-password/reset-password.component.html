<div class="auth-wrapper forgot-container">
  <div class="auth-wrapper__left">
    <div class="signup-container">
      <div class="signup-container__title">Reset Password</div>

      <p *ngIf="!hasToken" class="signup-container__subtitle">
        Enter your registered email to get password reset link! </p>

      <p *ngIf="hasToken" class="signup-container__subtitle">
        Enter your new password </p>

      <form #forgotForm="ngForm" (ngSubmit)="onSubmit(forgotForm)" class="signup-container__form">

        <div *ngIf="!hasToken" class="signup-container__form-group">
          <label class="signup-container__label">Register Mail</label> <input [(ngModel)]="email" id="id_companymail"
            placeholder="Enter your registered mail" class="signup-container__input" name="companymail" required
            type="email" />
        </div>

        <div *ngIf="hasToken">
          <div class="signup-container__form-group">
            <label class="signup-container__label">New Password</label> <input [(ngModel)]="password"
              (input)="onPasswordInput(password)" type="password" placeholder="Enter new password"
              class="signup-container__input" name="password" required />

            <div *ngIf="showPasswordMeter">
              <div class="password-strength-bar">
                <div class="strength-fill" [ngClass]="{
                                    'bg-danger bg-opacity-50': passwordStrength === 'weak',
                                    'bg-warning bg-opacity-50': passwordStrength === 'medium',
                                    'bg-success bg-opacity-50': passwordStrength === 'strong'
                                    }"
                  [style.width.%]="passwordStrength === 'weak' ? 33 : passwordStrength === 'medium' ? 66 : 100"></div>
              </div>

              <ul class="password-checklist">
                <li *ngIf="currentUnmetCheck">{{ currentUnmetCheck }}</li>
              </ul>
            </div>
          </div>

          <div class="signup-container__form-group">
            <label class="signup-container__label">Confirm Password</label> <input [(ngModel)]="confirmPassword"
              name="confirmPassword" placeholder="Confirm new password" class="signup-container__input" required
              minlength="8" type="password" />
          </div>

          <div
            *ngIf="password && confirmPassword && password !== confirmPassword && (!showPasswordMeter || passwordStrength === 'strong')"
            class="w-100 d-block mt-2 px-3 py-2 rounded-lg bg-danger bg-opacity-75 text-white shadow-sm">
            <i class="bi bi-exclamation-diamond-fill me-2"></i>
            Password and confirm password do not match
          </div>


        </div>
        <div *ngIf="errorMessage"
          class="w-100 d-block mt-2 px-3 py-2 rounded-lg bg-danger bg-opacity-75 text-white shadow-sm">

          <i class="bi bi-exclamation-diamond-fill me-2"></i>
          {{ errorMessage }}
        </div>

        <div>
          <input [disabled]="hasToken ? (!forgotForm.valid || password !== confirmPassword || !allPasswordRequirementsMet) :
                            !forgotForm.valid" [class.signup-container__button]="
                            hasToken ? (forgotForm.valid && password === confirmPassword && allPasswordRequirementsMet) : forgotForm.valid
                            " [class.signup-container__button-disabled]="
                            hasToken ? (!forgotForm.valid || password !== confirmPassword || !allPasswordRequirementsMet) : !forgotForm.valid
                            " type="submit" [value]="hasToken ? 'Reset Password' : 'Get reset link'" />
        </div>
      </form>
    </div>
  </div>
</div>